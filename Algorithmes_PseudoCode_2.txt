
 Tu es un **architecte full-stack senior (Frontend + Backend)** sp√©cialis√© dans les **dashboards administrateurs professionnels**, la **gestion de donn√©es MySQL**, les **API Express.js**, et les **interfaces √©pur√©es de type desktop**.

---

### üéØ OBJECTIF G√âN√âRAL

Cr√©er **une page r√©pertoire administrateur** permettant de **surveiller, centraliser et g√©rer toutes les insertions utilisateurs** effectu√©es sur diff√©rentes zones du site de la **Fondation Delon Tena Tena**.

Cette page doit **r√©cup√©rer, afficher, filtrer, rechercher et exporter** toutes les donn√©es provenant des tables MySQL existantes, **en s‚Äôappuyant strictement sur l‚ÄôAPI Express fournie**.

---

## üß© STRUCTURE DE LA PAGE (4 SECTIONS)

### 1Ô∏è‚É£ SECTION NEWSLETTER

* Afficher **tous les enregistrements** de la table `newsletter`
* Champs visibles : pr√©nom, nom, email, pays, date
* Fonctionnalit√©s :

  * Barre de recherche
  * Filtrage
  * Export (TXT, PDF, CSV)

---

### 2Ô∏è‚É£ SECTION STEPPER (FORMULAIRE DE PARTICIPATION)

Afficher **toutes les donn√©es li√©es √† un participant**, regroup√©es par participant :

#### a) Participant

* Donn√©es issues de la table `stepper_participants`

#### b) Invit√©s

* Donn√©es issues de la table `stepper_invitations`
* Affich√©es sous le participant correspondant

#### c) M√©thode de paiement

* Donn√©es issues de la table `stepper_donations`

#### d) Classement des influenceurs

* Donn√©es issues de la table `analytics`
* Affichage **type classement Premier League** :

  * Position (1 ‚Üí dernier)
  * Nom influenceur
  * Nombre total de votes
* Classement dynamique bas√© sur `total_votes`

Fonctionnalit√©s :

* Recherche
* Filtres
* Export structur√©

---

### 3Ô∏è‚É£ SECTION BLOC D√âTAILL√â DES PARTICIPANTS

* Donn√©es issues uniquement de la table `stepper_participants`
* Afficher :

  * Nombre total de participants
  * Liste compl√®te des participants
* Tri alphab√©tique
* Recherche instantan√©e
* Export des donn√©es

---

### 4Ô∏è‚É£ SECTION FORMULAIRE DE CONTACT

* Donn√©es issues de la table `contact`
* Champs affich√©s : nom, email, sujet, message, date

#### üî• FONCTIONNALIT√â SP√âCIALE FEEDBACK

* Ajouter une **ic√¥ne SVG** √† c√¥t√© de chaque email
* Au clic :

  * Ouverture d‚Äôun **mini-formulaire de r√©ponse**
  * **Autocompl√©tion automatique** :

    * Email du destinataire
    * Sujet original
  * Envoi du message via **EmailJS**
  * Aucun champ √† ressaisir par l‚Äôadministrateur

---

## üé® DESIGN & UX (OBLIGATOIRE)

### üé® Style visuel

* Style **desktop √©pur√© inspir√© MacOS**
* ‚ùå Aucune mention d‚ÄôApple
* Espaces larges, cartes respirantes, ombres douces
* Layouts modernes et a√©r√©s

### üé® Couleurs & socle de design (√Ä UTILISER STRICTEMENT)

```css
:root{
  --green-soft:#3EB489;
  --green-deep:#5A9E78;
  --deep-green:#2E6B4F;
  --beige:#F8F5F0;
  --white:#FFFFFF;
  --footer-beige:#E6D8B9;
  --accent-brown:#C2A88C;
  --text-dark:#4A4A4A;
  --shadow-green:rgba(90,158,120,0.15);
  --shadow-deep:rgba(90,158,120,0.1);
  --radius:16px;
  --max-width:1200px;
  --transition:all 0.3s ease;
}
```Api server.js
const express = require("express");
const cors = require("cors");
const mysql = require("mysql2/promise");

const app = express();

/* ---------- Middleware ---------- */
app.use(cors());
app.use(express.json());

/* ---------- MySQL Connection ---------- */
const pool = mysql.createPool({
  host: "localhost",
  user: "root",
  password: "8748Mkrs",
  database: "fondation_delon",
  waitForConnections: true,
  connectionLimit: 10
});

/* ---------- Routes ---------- */

/* Subscribe */
app.post("/api/newsletter/subscribe", async (req, res) => {
  const { prenom, nom, email, pays } = req.body;

  if (!prenom || !nom || !email || !pays) {
    return res.status(400).json({ message: "Donn√©es invalides." });
  }

  try {
    await pool.execute(
      `INSERT INTO newsletter (prenom, nom, email, pays)
       VALUES (?, ?, ?, ?)`,
      [prenom, nom, email, pays]
    );

    res.status(201).json({ message: "Abonnement enregistr√©." });
    console.log("Abonnement r√©ussi √† la newsletter.");

  } catch (err) {
    if (err.code === "ER_DUP_ENTRY") {
      return res.status(409).json({ message: "Email d√©j√† abonn√©." });
    }
    res.status(500).json({ message: "Erreur serveur." });
    
  }
});

/* Unsubscribe */
app.delete("/api/newsletter/unsubscribe", async (req, res) => {
  const { email } = req.body;

  if (!email) {
    return res.status(400).json({ message: "Email requis." });
  }

  const [result] = await pool.execute(
    "DELETE FROM newsletter WHERE email = ?",
    [email]
  );

  if (result.affectedRows === 0) {
    return res.status(404).json({ message: "Email non trouv√©." });
  }

  res.json({ message: "D√©sabonnement effectu√©." });
});
// Stepper √âtape 1 ‚Äî Cr√©ation participant (avec anti-duplicat email)
app.post('/api/stepper/step1', async (req, res) => {
  console.log('‚û°Ô∏è POST /api/stepper/step1', req.body);

  const { lastName, firstName, email, phone, social, profile } = req.body;

  if (!lastName || !firstName || !email) {
    console.warn('‚ùå Donn√©es step1 incompl√®tes');
    return res.status(400).json({ error: 'Donn√©es incompl√®tes' });
  }

  try {
    // üîç V√©rification email d√©j√† utilis√©
    const [[existing]] = await pool.execute(
      `SELECT id FROM stepper_participants WHERE email = ? LIMIT 1`,
      [email]
    );

    if (existing) {
      console.warn('‚ö†Ô∏è Email d√©j√† utilis√© :', email);
      return res.status(409).json({
        error: 'EMAIL_ALREADY_USED',
        message: 'Cet email est d√©j√† associ√© √† un participant.'
      });
    }

    // ‚úÖ Insertion
    const [result] = await pool.execute(
      `INSERT INTO stepper_participants 
       (last_name, first_name, email, phone, social_network, social_profile)
       VALUES (?, ?, ?, ?, ?, ?)`,
      [lastName, firstName, email, phone, social || null, profile || null]
    );

    console.log('‚úÖ Participant cr√©√© ID =', result.insertId);
    res.json({ participantId: result.insertId });

  } catch (err) {
    console.error('‚ùå Erreur step1', err);
    res.status(500).json({ error: 'Erreur serveur step1' });
  }
});

//Update nouveau partcipant
app.put('/api/stepper/participant/:id', async (req, res) => {
  console.log(`‚û°Ô∏è PUT /api/stepper/participant/${req.params.id}`, req.body);

  const fields = [];
  const values = [];

  for (const [key, val] of Object.entries(req.body)) {
    fields.push(`${key} = ?`);
    values.push(val);
  }

  if (!fields.length) {
    return res.status(400).json({ error: 'Aucune donn√©e √† mettre √† jour' });
  }

  values.push(req.params.id);

  await pool.execute(
    `UPDATE stepper_participants SET ${fields.join(', ')} WHERE id = ?`,
    values
  );

  console.log('‚úÖ Participant mis √† jour', req.params.id);

  res.json({ success: true });
});
// üì• Lecture de tous les participants (Pour la Campagne)
app.get('/api/stepper/participants', async (req, res) => {
  try {
    const [rows] = await pool.execute(`
      SELECT 
        id,
        first_name,
        last_name,
        social_network
      FROM stepper_participants
      ORDER BY last_name ASC
    `);

    res.json(rows);

  } catch (err) {
    console.error('‚ùå Erreur lecture participants', err);
    res.status(500).json({ error: 'Erreur lecture participants' });
  }
});
//Stepper Etape 2
app.post('/api/stepper/step2', async (req, res) => {
  console.log('‚û°Ô∏è POST /api/stepper/step2', req.body);

  const { participantId, invites } = req.body;

  if (!participantId || !Array.isArray(invites)) {
    return res.status(400).json({
      error: 'INVALID_DATA',
      message: 'Donn√©es invalides'
    });
  }

  try {
    // üî• Nettoyage anti-doublon
    await pool.execute(
      `DELETE FROM stepper_invitations WHERE participant_id = ?`,
      [participantId]
    );

    let inserted = 0;

    for (const inv of invites) {
      const { last, first, social, profile } = inv;

      if (!last || !first || !social || !profile) continue;

      await pool.execute(
        `INSERT INTO stepper_invitations
         (participant_id, last_name, first_name, social_network, social_profile)
         VALUES (?, ?, ?, ?, ?)`,
        [participantId, last, first, social, profile]
      );

      inserted++;
    }

    console.log(`‚úÖ ${inserted} invitations enregistr√©es`);

    return res.status(200).json({
      success: true,
      message: 'Invitations enregistr√©es avec succ√®s',
      inserted
    });

  } catch (err) {
    console.error('‚ùå Erreur step2', err);
    return res.status(500).json({
      error: 'SERVER_ERROR',
      message: 'Erreur serveur lors de l‚Äôenregistrement'
    });
  }
});

//Stepper Etape 3 VOTE 
app.post('/api/analytics/vote', async (req, res) => {
  const { participantId, influencerNames } = req.body;

  for (const name of influencerNames) {
    const [[inf]] = await pool.execute(
      `SELECT id FROM analytics WHERE influencer_name = ?`,
      [name]
    );

    await pool.execute(
      `INSERT IGNORE INTO analytics_votes (influencer_id, participant_id)
       VALUES (?, ?)`,
      [inf.id, participantId]
    );

    await pool.execute(
      `UPDATE analytics SET total_votes = total_votes + 1 WHERE id = ?`,
      [inf.id]
    );
  }
  res.json({ success: true });
});
// üì• Lecture de tous les influenceurs (STEP 3)
app.get('/api/analytics/influencers', async (req, res) => {
  console.log('üì• GET /api/analytics/influencers');

  try {
    const [rows] = await pool.execute(`
      SELECT 
        id,
        influencer_name,
        image_path,
        sector,
        status
      FROM analytics
      ORDER BY influencer_name ASC
    `);

    console.log(`‚úÖ ${rows.length} influenceurs charg√©s`);
    res.json(rows);

  } catch (err) {
    console.error('‚ùå Erreur lecture analytics', err);
    res.status(500).json({ error: 'Erreur serveur analytics' });
  }
});
//Barre de recherche Etape 3
app.get('/api/analytics/search', async (req, res) => {
  const q = `%${req.query.q || ''}%`;
  console.log('üîç SEARCH analytics:', q);

  try {
    const [rows] = await pool.execute(`
      SELECT 
        id,
        influencer_name,
        image_path,
        sector,
        status
      FROM analytics
      WHERE influencer_name LIKE ?
      ORDER BY influencer_name ASC
    `, [q]);

    console.log(`‚úÖ ${rows.length} r√©sultat(s) search`);
    res.json(rows);

  } catch (err) {
    console.error('‚ùå Erreur search analytics', err);
    res.status(500).json({ error: 'Erreur search analytics' });
  }
});
// üìäCalculs Analytiques r√©els pour un influenceur
app.get('/api/analytics/stats/:name', async (req, res) => {
  const influencerName = req.params.name;

  try {
    // üî¢ Votes totaux globaux
    const [[total]] = await pool.execute(
      `SELECT SUM(total_votes) AS totalVotes FROM analytics`
    );

    // üéØ Donn√©es influenceur + ranking
    const [rows] = await pool.execute(`
      SELECT 
        a.id,
        a.influencer_name,
        a.total_votes,
        RANK() OVER (ORDER BY a.total_votes DESC) AS rank_position
      FROM analytics a
    `);

    const current = rows.find(r => r.influencer_name === influencerName);
    if (!current) return res.status(404).json({ error: 'Influenceur introuvable' });

    // üìà √âvolution des votes (line chart)
    const [timeline] = await pool.execute(`
      SELECT 
        DATE(av.created_at) AS vote_date,
        COUNT(*) AS votes
      FROM analytics_votes av
      JOIN analytics a ON a.id = av.influencer_id
      WHERE a.influencer_name = ?
      GROUP BY vote_date
      ORDER BY vote_date ASC
    `, [influencerName]);

    // üìä Bar chart (comparaison)
    const [bars] = await pool.execute(`
      SELECT influencer_name, total_votes
      FROM analytics
      ORDER BY total_votes DESC
      LIMIT 6
    `);

    res.json({
      votes: current.total_votes,
      percent: total.totalVotes
        ? Math.round((current.total_votes / total.totalVotes) * 100)
        : 0,
      rank: current.rank_position,
      trend: timeline.length > 1 &&
             timeline[timeline.length - 1].votes >
             timeline[timeline.length - 2].votes
             ? '‚Üó' : '‚Üí',
      barData: bars.map(b => b.total_votes),
      barLabels: bars.map(b => b.influencer_name),
      lineData: timeline.map(t => t.votes)
    });

  } catch (err) {
    console.error('‚ùå Analytics error', err);
    res.status(500).json({ error: 'Erreur analytics' });
  }
});
//Lecture par le participant
app.get('/api/stepper/participant/:id', async (req, res) => {
  const [rows] = await pool.execute(
    `SELECT * FROM stepper_participants WHERE id = ?`,
    [req.params.id]
  );

  res.json(rows[0] || null);
});
// Stepper √âtape 4 ‚Äî Donation
app.post('/api/stepper/step4', async (req, res) => {
  console.log('‚û°Ô∏è POST /api/stepper/step4', req.body);

  const { participantId, paymentMethod } = req.body;

  if (!participantId || !paymentMethod) {
    return res.status(400).json({ error: 'participantId et paymentMethod requis' });
  }

  try {
    // üîÅ Anti-doublon : 1 choix par participant
    await pool.execute(
      `DELETE FROM stepper_donations WHERE participant_id = ?`,
      [participantId]
    );

    await pool.execute(
      `INSERT INTO stepper_donations (participant_id, payment_method)
       VALUES (?, ?)`,
      [participantId, paymentMethod]
    );

    console.log('‚úÖ Donation enregistr√©e', participantId, paymentMethod);
    res.json({ success: true });

  } catch (err) {
    console.error('‚ùå Erreur step4 donation', err);
    res.status(500).json({ error: 'Erreur serveur donation' });
  }
});
app.use((req, res, next) => {
  console.log(`‚û°Ô∏è ${req.method} ${req.url}`, req.body);
  next();
});
/* ---------- Contact ---------- */
app.post('/api/contact', async (req, res) => {
  const { name, email, subject, message } = req.body;

  if (!name || !email || !subject || !message) {
    return res.status(400).json({ message: 'Donn√©es invalides.' });
  }

  try {
    await pool.execute(
      `INSERT INTO contact (name, email, subject, message)
       VALUES (?, ?, ?, ?)`,
      [name, email, subject, message]
    );

    console.log('üì© Nouveau message contact enregistr√©');
    res.status(201).json({ success: true });

  } catch (err) {
    console.error('‚ùå Erreur contact', err);
    res.status(500).json({ message: 'Erreur serveur contact.' });
  }
});
app.get("/", (req, res) => {
  res.send("‚úÖ API Fondation Delon op√©rationnelle");
});
/* ---------- Server ---------- */
const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
  console.log(`‚úÖ Serveur actif sur http://localhost:${PORT}`);
});
---

## üß≠ NAVIGATION & ERGONOMIE

* Header professionnel fixe
* Menu hamburger responsive (mobile)
* Navigation interne fluide vers chaque section
* √âviter les longs scrolls
* Chaque section doit √™tre **autonome**

---

## üì§ EXPORT DES DONN√âES

* Export par section :

  * TXT
  * PDF
  * CSV
* Mise en page propre apr√®s t√©l√©chargement
* Respect des hi√©rarchies visuelles (titres, tableaux, espacements)

---

## ‚öôÔ∏è CONTRAINTES TECHNIQUES

* G√©n√©rer **l‚Äôensemble du code complet** :

  * HTML
  * CSS
  * JavaScript
  * Connexions API (fetch)
* Aucun pseudo-code
* Aucune partie manquante
* Compatible avec l‚ÄôAPI Express + MySQL fournie
* Commentaires clairs et professionnels


## üß† LIVRABLE ATTENDU

1. G√©n√©ration imm√©diate du **code complet**
2. Courtes explications section par section
3. Code pr√™t √† √™tre ex√©cut√© sans modification majeure

Traduire ou proposer en anglais tous les messages toast pr√©sents dans le script en r√©utilisant la m√©thode qui s'occupe de la conversion de langue.
Contexte : la page propose deux langues (Fran√ßais et Anglais) avec une structure simple data-fr et data-en qui, c√¥t√© html est bien g√©r√©e mais 
certains textes c√¥t√©s (Backend) script ne sont qu'en  fran√ßais. L'objectif est de proposer une traduction compl√®te du site en anglais c√¥t√© script. 
Voici un exemple simple de code √† mettre dans le toast (document.body.classList.contains('en') ? 'No influencer selected.' : 'Aucun influenceur s√©lectionn√©.')
Adopter cet exemple en utilisant la d√©claration de toast pr√©cis dans le script. 
Les ressources :
SCRIPT 
